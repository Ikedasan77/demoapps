{% load static %}  <!-- Djangoã®é™çš„ãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿ã‚’ä½¿ã† -->

<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css">
    <link rel="icon" href="{% static 'favicon.ico' %}">  <!-- ãƒ•ã‚¡ãƒ“ã‚³ãƒ³ã®ãƒªãƒ³ã‚¯ã‚’è¿½åŠ  -->
    <title>è¨ˆç®—ã‚¢ãƒ—ãƒª</title>
    <script type="text/javascript" async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js">
    </script>  <!-- MathJaxãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’èª­ã¿è¾¼ã‚“ã§LaTeXå½¢å¼ã®æ•°å¼ã‚’ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚° -->
    <style>
        /* å¤‰æ›´: èƒŒæ™¯å…¨ä½“ã«å·¦å³ã®ä½™ç™½éƒ¨åˆ†ã‚’é…è‰² */
        body {
            background: linear-gradient(to right, #00AEEF, #00AEEF) no-repeat, #f5f5f5;
            background-size: 100vw 100%;
            font-family: 'Noto Sans JP', sans-serif; /* èª­ã¿ã‚„ã™ã„ãƒ•ã‚©ãƒ³ãƒˆã‚’æŒ‡å®š */
        }

        /* å•é¡Œãƒ»å›ç­”éƒ¨åˆ†ã®ä¸­å¤®è¡¨ç¤º */
        .quiz-container {
            background-color: #ffffff;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            max-width: 900px;
            margin: 40px auto;
            text-align: center;
        }

        /* å•é¡Œã‚«ãƒ¼ãƒ‰ãƒ‡ã‚¶ã‚¤ãƒ³ */
        .question-container {
            display: flex; /* å¤‰æ›´: å•é¡Œç•ªå·ã¨å•é¡Œæ–‡ã‚’æ¨ªä¸¦ã³ã« */
            align-items: center; /* ç¸¦ã®ä¸­å¤®æƒãˆ */
            margin-bottom: 15px;
            background-color: #f0f8ff; /* è–„ã„é’è‰² */
            border-radius: 10px;
            padding: 15px;
            text-align: left;
            border: 2px solid #90caf9; /* æ ç·šã‚’å¼·èª¿ */
        }

        /* ç•ªå·ãƒ‡ã‚¶ã‚¤ãƒ³ */
        .question-number {
            display: inline-block;
            font-size: 1.8rem; /* å¤§ãã‚ã®ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚º */
            font-weight: bold;
            color: white;
            background-color: #ff7043; /* ã‚ªãƒ¬ãƒ³ã‚¸è‰²ã®ä¸¸èƒŒæ™¯ */
            width: 50px; /* å¤‰æ›´: å¹…ã‚’åºƒã’ã¦å®‰å®šæ„Ÿã‚’å¢—åŠ  */
            height: 50px; /* å¤‰æ›´: é«˜ã•ã‚‚èª¿æ•´ */
            line-height: 50px;
            text-align: center;
            border-radius: 50%; /* ä¸¸ãã™ã‚‹ */
            margin-right: 15px; /* å•é¡Œæ–‡ã¨ã®é–“éš”ã‚’åºƒã’ã‚‹ */
        }

        /* å•é¡Œæ–‡ã®ã‚¹ã‚¿ã‚¤ãƒ« */
        .question-text {
            font-size: 1.4rem; /* æ–‡å­—ã‚’ã•ã‚‰ã«å¤§ãã */
            white-space: pre-wrap; /* æ”¹è¡Œã‚’ä¿æŒ */
        }

        /* å…¥åŠ›æ¬„ã®ãƒ‡ã‚¶ã‚¤ãƒ³ */
        .answer-input {
            width: 100%;
            padding: 12px;
            border: 2px solid #ccc;
            border-radius: 5px;
            text-align: center;
            font-size: 1.2rem;
            box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.1);
            margin-top: 10px; /* å¤‰æ›´: å…¥åŠ›æ¬„ã¨å•é¡Œæ–‡ã®é–“éš”ã‚’èª¿æ•´ */
        }

        /* èƒŒæ™¯éƒ¨åˆ†ã®è¦–èªæ€§å‘ä¸Š */
        .timer-container, #timer {
            color: #333;
            background-color: rgba(255, 255, 255, 0.9); /* ç™½åœ°ã«é€æ˜æ„Ÿã‚’è¿½åŠ  */
            padding: 10px;
            border-radius: 10px;
            max-width: 500px;
            margin: 10px auto;
            text-align: center;
        }

        select {
            padding: 5px;
            font-size: 1.2rem;
            border: 1px solid #ccc;
            border-radius: 5px;
        }

        /* ã‚¿ã‚¤ãƒˆãƒ«ã®ã‚¹ã‚¿ã‚¤ãƒ« */
        h1 {
            font-size: 2.5rem;
            color: #424242;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <div class="flex justify-center items-center mt-10">
        <h1>è¨ˆç®—ã‚¢ãƒ—ãƒª</h1>
        <button onclick="playMusic()" class="ml-4 bg-yellow-500 text-white px-4 py-2 rounded hover:bg-yellow-600">ğŸº éŸ³æ¥½ã‚’é³´ã‚‰ã™</button>
    </div>

    <div class="timer-container">
        <label for="timer-select" class="timer-label">åˆ¶é™æ™‚é–“ã‚’é¸æŠ:</label>
        <select id="timer-select">
            <option value="360">360ç§’</option>
            <option value="480">480ç§’</option>
            <option value="600">600ç§’</option>
        </select>
        <button onclick="startTimer()" class="ml-4 bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600">é–‹å§‹</button>
    </div>

    <div id="timer" class="text-center text-lg mt-4">æ®‹ã‚Šæ™‚é–“: -- ç§’</div>

    <div class="quiz-container">
        <form id="quiz-form" method="post" action="/result/"> <!-- è§£èª¬ç”»é¢ã«é·ç§»ã™ã‚‹URLã‚’è¨­å®š -->
            {% csrf_token %} <!-- CSRFãƒˆãƒ¼ã‚¯ãƒ³ã‚’è¿½åŠ  -->
            {% for question in questions %}
                <div class="question-container">
                    <span class="question-number">{{ forloop.counter }}</span>
                    <div>
                        <p class="question-text">\( \displaystyle {{ question.text }} \)</p>
                        <input type="text" id="answer_{{ forloop.counter0 }}" name="answer_{{ forloop.counter0 }}"
                               class="answer-input" placeholder="å›ç­”ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„">
                        <!-- hidden ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã§ question.id ã‚’é€ä¿¡ -->
                        <input type="hidden" name="question_id_{{ forloop.counter0 }}" value="{{ question.id }}">
                    </div>
                </div>
            {% endfor %}
            <div class="text-center mt-6">
                <button type="submit" class="bg-blue-500 text-white px-6 py-2 rounded hover:bg-blue-600">
                    å›ç­”ã‚’é€ä¿¡
                </button>
            </div>
        </form>
    </div>

    <!-- éŸ³æ¥½å†ç”Ÿç”¨ã®JavaScript -->
    <script>
        let musicAudio = new Audio("{% static 'audio/thinkingtime2.mp3' %}");
        musicAudio.volume = 0.75;

        function playMusic() {
            musicAudio.play();
        }

        let timer = 0;
        let timerInterval;

        function startTimer() {
            const timerSelect = document.getElementById('timer-select');
            timer = parseInt(timerSelect.value);

            const timerElement = document.getElementById('timer');
            timerElement.textContent = `æ®‹ã‚Šæ™‚é–“: ${timer}ç§’`;

            if (timerInterval) {
                clearInterval(timerInterval);
            }

            timerInterval = setInterval(() => {
                timer--;
                timerElement.textContent = `æ®‹ã‚Šæ™‚é–“: ${timer}ç§’`;
                if (timer <= 0) {
                    clearInterval(timerInterval);
                    timerElement.textContent = 'æ™‚é–“åˆ‡ã‚Œ!';
                    document.getElementById('quiz-form').submit();
                }
            }, 1000);
        }
    </script>
</body>
</html>
